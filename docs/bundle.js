!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){var n;!function(r,i,o,a){"use strict";var s,c,u={URL:r.URL||r.webkitURL||r.mozURL||r.msURL,getUserMedia:(c=o.getUserMedia||o.webkitGetUserMedia||o.mozGetUserMedia||o.msGetUserMedia,c?c.bind(o):c),requestAnimFrame:r.requestAnimationFrame||r.webkitRequestAnimationFrame||r.mozRequestAnimationFrame||r.oRequestAnimationFrame||r.msRequestAnimationFrame,requestTimeout:function(e,t){if(e=e||u.noop,t=t||0,!u.requestAnimFrame)return setTimeout(e,t);var r=(new Date).getTime(),n=new Object,i=u.requestAnimFrame;return n.value=i((function o(){(new Date).getTime()-r>=t?e.call():n.value=i(o)})),n},Blob:r.Blob||r.BlobBuilder||r.WebKitBlobBuilder||r.MozBlobBuilder||r.MSBlobBuilder,btoa:(s=r.btoa||function(e){for(var t="",r=0,n=e.length,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=void 0,a=void 0,s=void 0,c=void 0,u=void 0,l=void 0,d=void 0;r<n;)c=(o=e.charCodeAt(r++))>>2,u=(3&o)<<4|(a=e.charCodeAt(r++))>>4,l=(15&a)<<2|(s=e.charCodeAt(r++))>>6,d=63&s,isNaN(a)?l=d=64:isNaN(s)&&(d=64),t=t+i.charAt(c)+i.charAt(u)+i.charAt(l)+i.charAt(d);return t},s?s.bind(r):u.noop),isObject:function(e){return e&&"[object Object]"===Object.prototype.toString.call(e)},isEmptyObject:function(e){return u.isObject(e)&&!Object.keys(e).length},isArray:function(e){return e&&Array.isArray(e)},isFunction:function(e){return e&&"function"==typeof e},isElement:function(e){return e&&1===e.nodeType},isString:function(e){return"string"==typeof e||"[object String]"===Object.prototype.toString.call(e)},isSupported:{canvas:function(){var e=i.createElement("canvas");return e&&e.getContext&&e.getContext("2d")},webworkers:function(){return r.Worker},blob:function(){return u.Blob},Uint8Array:function(){return r.Uint8Array},Uint32Array:function(){return r.Uint32Array},videoCodecs:function(){var e=i.createElement("video"),t={mp4:!1,h264:!1,ogv:!1,ogg:!1,webm:!1};try{e&&e.canPlayType&&(t.mp4=""!==e.canPlayType('video/mp4; codecs="mp4v.20.8"'),t.h264=""!==(e.canPlayType('video/mp4; codecs="avc1.42E01E"')||e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')),t.ogv=""!==e.canPlayType('video/ogg; codecs="theora"'),t.ogg=""!==e.canPlayType('video/ogg; codecs="theora"'),t.webm=-1!==e.canPlayType('video/webm; codecs="vp8, vorbis"'))}catch(e){}return t}()},noop:function(){},each:function(e,t){var r=void 0,n=void 0;if(u.isArray(e))for(r=-1,n=e.length;++r<n&&!1!==t(r,e[r]););else if(u.isObject(e))for(r in e)if(e.hasOwnProperty(r)&&!1===t(r,e[r]))break},mergeOptions:function(e,t){if(u.isObject(e)&&u.isObject(t)&&Object.keys){var r={};return u.each(e,(function(t,n){r[t]=e[t]})),u.each(t,(function(n,i){var o=t[n];u.isObject(o)&&e[n]?r[n]=u.mergeOptions(e[n],o):r[n]=o})),r}},setCSSAttr:function(e,t,r){u.isElement(e)&&(u.isString(t)&&u.isString(r)?e.style[t]=r:u.isObject(t)&&u.each(t,(function(t,r){e.style[t]=r})))},removeElement:function(e){u.isElement(e)&&e.parentNode&&e.parentNode.removeChild(e)},createWebWorker:function(e){if(!u.isString(e))return{};try{var t=new u.Blob([e],{type:"text/javascript"}),r=u.URL.createObjectURL(t);return{objectUrl:r,worker:new Worker(r)}}catch(e){return""+e}},getExtension:function(e){return e.substr(e.lastIndexOf(".")+1,e.length)},getFontSize:function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{};if(!i.body||!1===e.resizeFont)return e.fontSize;var t=e.text,r=e.gifWidth,n=parseInt(e.fontSize,10),o=parseInt(e.minFontSize,10),s=i.createElement("div"),c=i.createElement("span");for(s.setAttribute("width",r),s.appendChild(c),c.innerHTML=t,c.style.fontSize=n+"px",c.style.textIndent="-9999px",c.style.visibility="hidden",i.body.appendChild(c);c.offsetWidth>r&&n>=o;)c.style.fontSize=--n+"px";return i.body.removeChild(c),n+"px"},webWorkerError:!1},l=Object.freeze({default:u}),d={validate:function(e){e=u.isObject(e)?e:{};var t={};return u.each(d.validators,(function(r,n){var i=n.errorCode;if(!e[i]&&!n.condition)return(t=n).error=!0,!1})),delete t.condition,t},isValid:function(e){var t=!0!==d.validate(e).error;return t},validators:[{condition:u.isFunction(u.getUserMedia),errorCode:"getUserMedia",errorMsg:"The getUserMedia API is not supported in your browser"},{condition:u.isSupported.canvas(),errorCode:"canvas",errorMsg:"Canvas elements are not supported in your browser"},{condition:u.isSupported.webworkers(),errorCode:"webworkers",errorMsg:"The Web Workers API is not supported in your browser"},{condition:u.isFunction(u.URL),errorCode:"window.URL",errorMsg:"The window.URL API is not supported in your browser"},{condition:u.isSupported.blob(),errorCode:"window.Blob",errorMsg:"The window.Blob File API is not supported in your browser"},{condition:u.isSupported.Uint8Array(),errorCode:"window.Uint8Array",errorMsg:"The window.Uint8Array function constructor is not supported in your browser"},{condition:u.isSupported.Uint32Array(),errorCode:"window.Uint32Array",errorMsg:"The window.Uint32Array function constructor is not supported in your browser"}],messages:{videoCodecs:{errorCode:"videocodec",errorMsg:"The video codec you are trying to use is not supported in your browser"}}},f=Object.freeze({default:d}),h=function(){},p={sampleInterval:10,numWorkers:2,filter:"",gifWidth:200,gifHeight:200,interval:.1,numFrames:10,frameDuration:1,keepCameraOn:!1,images:[],video:null,webcamVideoElement:null,cameraStream:null,text:"",fontWeight:"normal",fontSize:"16px",minFontSize:"10px",resizeFont:!1,fontFamily:"sans-serif",fontColor:"#ffffff",textAlign:"center",textBaseline:"bottom",textXCoordinate:null,textYCoordinate:null,progressCallback:h,completeCallback:h,saveRenderingContexts:!1,savedRenderingContexts:[],showFrameText:!0,crossOrigin:"Anonymous",waterMark:null,waterMarkHeight:null,waterMarkWidth:null,waterMarkXCoordinate:1,waterMarkYCoordinate:1},m=Object.freeze({default:p});function g(){return d.isValid()}function b(){var e,t,r,n,i,o=256,a=499,s=491,c=487,u=503,l=3*u,d=o-1,f=4,h=100,p=16,m=1<<p,g=10,b=10,v=m>>b,y=m<<g-b,w=6,x=(o>>3)*(1<<w),S=30,E=1024,_=256,k=1<<18,C=[],O=[],F=[],T=[];function A(e,t,r,n,a){var s,c,u,l,d,f,h;for((u=t-e)<-1&&(u=-1),(l=t+e)>o&&(l=o),s=t+1,c=t-1,f=1;s<l||c>u;){if(d=T[f++],s<l){h=i[s++];try{h[0]-=d*(h[0]-r)/k|0,h[1]-=d*(h[1]-n)/k|0,h[2]-=d*(h[2]-a)/k|0}catch(e){}}if(c>u){h=i[c--];try{h[0]-=d*(h[0]-r)/k|0,h[1]-=d*(h[1]-n)/k|0,h[2]-=d*(h[2]-a)/k|0}catch(e){}}}}function M(e,t,r,n,o){var a=i[t],s=e/E;a[0]-=s*(a[0]-r)|0,a[1]-=s*(a[1]-n)|0,a[2]-=s*(a[2]-o)|0}function W(e,t,r){var n,a,s,c,u,l,d,h,m,w;for(m=h=~(1<<31),d=l=-1,n=0;n<o;n++)(a=(w=i[n])[0]-e)<0&&(a=-a),(s=w[1]-t)<0&&(s=-s),a+=s,(s=w[2]-r)<0&&(s=-s),(a+=s)<h&&(h=a,l=n),(c=a-(O[n]>>p-f))<m&&(m=c,d=n),u=F[n]>>b,F[n]-=u,O[n]+=u<<g;return F[l]+=v,O[l]-=y,d}(function(e,a,s){var c,u;for(t=e,r=a,n=s,i=new Array(o),c=0;c<o;c++)i[c]=new Array(4),(u=i[c])[0]=u[1]=u[2]=(c<<f+8)/o|0,F[c]=m/o|0,O[c]=0}).apply(this,arguments);var j={map:function(e,t,r){var n,a,s,c,u,l,d;for(u=1e3,d=-1,a=(n=C[t])-1;n<o||a>=0;)n<o&&((s=(l=i[n])[1]-t)>=u?n=o:(n++,s<0&&(s=-s),(c=l[0]-e)<0&&(c=-c),(s+=c)<u&&((c=l[2]-r)<0&&(c=-c),(s+=c)<u&&(u=s,d=l[3])))),a>=0&&((s=t-(l=i[a])[1])>=u?a=-1:(a--,s<0&&(s=-s),(c=l[0]-e)<0&&(c=-c),(s+=c)<u&&((c=l[2]-r)<0&&(c=-c),(s+=c)<u&&(u=s,d=l[3]))));return d},process:function(){return function(){var i,o,d,p,m,g,b,v,y,k,C,O,F,j;for(r<l&&(n=1),e=30+(n-1)/3,O=t,F=0,j=r,k=(C=r/(3*n))/h|0,v=E,(b=(g=x)>>w)<=1&&(b=0),i=0;i<b;i++)T[i]=v*((b*b-i*i)*_/(b*b));for(y=r<l?3:r%a!=0?3*a:r%s!=0?3*s:r%c!=0?3*c:3*u,i=0;i<C;)if(M(v,o=W(d=(255&O[F+0])<<f,p=(255&O[F+1])<<f,m=(255&O[F+2])<<f),d,p,m),0!==b&&A(b,o,d,p,m),(F+=y)>=j&&(F-=r),0===k&&(k=1),++i%k==0)for(v-=v/e,(b=(g-=g/S)>>w)<=1&&(b=0),o=0;o<b;o++)T[o]=v*((b*b-o*o)*_/(b*b))}(),function(){var e;for(e=0;e<o;e++)i[e][0]>>=f,i[e][1]>>=f,i[e][2]>>=f,i[e][3]=e}(),function(){var e,t,r,n,a,s,c,u;for(c=0,u=0,e=0;e<o;e++){for(r=e,n=(a=i[e])[1],t=e+1;t<o;t++)(s=i[t])[1]<n&&(r=t,n=s[1]);if(s=i[r],e!=r&&(t=s[0],s[0]=a[0],a[0]=t,t=s[1],s[1]=a[1],a[1]=t,t=s[2],s[2]=a[2],a[2]=t,t=s[3],s[3]=a[3],a[3]=t),n!=c){for(C[c]=u+e>>1,t=c+1;t<n;t++)C[t]=e;c=n,u=e}}for(C[c]=u+d>>1,t=c+1;t<256;t++)C[t]=d}(),function(){for(var e=[],t=new Array(o),r=0;r<o;r++)t[i[r][3]]=r;for(var n=0,a=0;a<o;a++){var s=t[a];e[n++]=i[s][0],e[n++]=i[s][1],e[n++]=i[s][2]}return e}()}};return j}function v(){try{this.onmessage=function(t){var r,n=t.data||{};n.gifshot&&(r=e.run(n),postMessage(r))}}catch(e){}var e={dataToRGB:function(e,t,r){for(var n=t*r*4,i=0,o=[];i<n;)o.push(e[i++]),o.push(e[i++]),o.push(e[i++]),i++;return o},componentizedPaletteToArray:function(e){e=e||[];for(var t=[],r=0;r<e.length;r+=3){var n=e[r],i=e[r+1],o=e[r+2];t.push(n<<16|i<<8|o)}return t},processFrameWithQuantizer:function(e,t,r,n){for(var i=this.dataToRGB(e,t,r),o=new b(i,i.length,n),a=o.process(),s=new Uint32Array(this.componentizedPaletteToArray(a)),c=t*r,u=new Uint8Array(c),l=0,d=0;d<c;d++){var f=i[l++],h=i[l++],p=i[l++];u[d]=o.map(f,h,p)}return{pixels:u,palette:s}},run:function(e){var t=e=e||{},r=t.height,n=(t.palette,t.sampleInterval),i=t.width,o=e.data;return this.processFrameWithQuantizer(o,i,r,n)}};return e}function y(e,t,r,n){var i=0,o=(n=n===a?{}:n).loop===a?null:n.loop,s=n.palette===a?null:n.palette;if(t<=0||r<=0||t>65535||r>65535)throw"Width/Height invalid.";e[i++]=71,e[i++]=73,e[i++]=70,e[i++]=56,e[i++]=57,e[i++]=97;if(e[i++]=255&t,e[i++]=t>>8&255,e[i++]=255&r,e[i++]=r>>8&255,e[i++]=0|(null!==s?128:0),e[i++]=0,e[i++]=0,null!==o){if(o<0||o>65535)throw"Loop count invalid.";e[i++]=33,e[i++]=255,e[i++]=11,e[i++]=78,e[i++]=69,e[i++]=84,e[i++]=83,e[i++]=67,e[i++]=65,e[i++]=80,e[i++]=69,e[i++]=50,e[i++]=46,e[i++]=48,e[i++]=3,e[i++]=1,e[i++]=255&o,e[i++]=o>>8&255,e[i++]=0}var c=!1;this.addFrame=function(t,r,n,o,u,l){if(!0===c&&(--i,c=!1),l=l===a?{}:l,t<0||r<0||t>65535||r>65535)throw"x/y invalid.";if(n<=0||o<=0||n>65535||o>65535)throw"Width/Height invalid.";if(u.length<n*o)throw"Not enough pixels for the frame size.";var d=!0,f=l.palette;if(f!==a&&null!==f||(d=!1,f=s),f===a||null===f)throw"Must supply either a local or global palette.";for(var h=function(e){var t=e.length;if(t<2||t>256||t&t-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return t}(f),p=0;h>>=1;)++p;h=1<<p;var m=l.delay===a?0:l.delay,g=l.disposal===a?0:l.disposal;if(g<0||g>3)throw"Disposal out of range.";var b=!1,v=0;if(l.transparent!==a&&null!==l.transparent&&(b=!0,(v=l.transparent)<0||v>=h))throw"Transparent color index.";if((0!==g||b||0!==m)&&(e[i++]=33,e[i++]=249,e[i++]=4,e[i++]=g<<2|(!0===b?1:0),e[i++]=255&m,e[i++]=m>>8&255,e[i++]=v,e[i++]=0),e[i++]=44,e[i++]=255&t,e[i++]=t>>8&255,e[i++]=255&r,e[i++]=r>>8&255,e[i++]=255&n,e[i++]=n>>8&255,e[i++]=255&o,e[i++]=o>>8&255,e[i++]=!0===d?128|p-1:0,!0===d)for(var y=0,w=f.length;y<w;++y){var x=f[y];e[i++]=x>>16&255,e[i++]=x>>8&255,e[i++]=255&x}i=function(e,t,r,n){e[t++]=r;var i=t++,o=1<<r,s=o-1,c=o+1,u=c+1,l=r+1,d=0,f=0;function h(r){for(;d>=r;)e[t++]=255&f,f>>=8,d-=8,t===i+256&&(e[i]=255,i=t++)}function p(e){f|=e<<d,d+=l,h(8)}var m=n[0]&s,g={};p(o);for(var b=1,v=n.length;b<v;++b){var y=n[b]&s,w=m<<8|y,x=g[w];if(x===a){for(f|=m<<d,d+=l;d>=8;)e[t++]=255&f,f>>=8,d-=8,t===i+256&&(e[i]=255,i=t++);4096===u?(p(o),u=c+1,l=r+1,g={}):(u>=1<<l&&++l,g[w]=u++),m=y}else m=x}p(m),p(c),h(1),i+1===t?e[i]=0:(e[i]=t-i-1,e[t++]=0);return t}(e,i,p<2?2:p,u)},this.end=function(){return!1===c&&(e[i++]=59,c=!0),i}}var w=function(){},x=function(e){this.canvas=null,this.ctx=null,this.repeat=0,this.frames=[],this.numRenderedFrames=0,this.onRenderCompleteCallback=w,this.onRenderProgressCallback=w,this.workers=[],this.availableWorkers=[],this.generatingGIF=!1,this.options=e,this.initializeWebWorkers(e)};x.prototype={workerMethods:v(),initializeWebWorkers:function(e){var t,r=b.toString()+"("+v.toString()+"());",n=void 0,o=void 0,a=void 0,s=-1,c="";for(t=e.numWorkers;++s<t;)n=u.createWebWorker(r),u.isObject(n)?(o=n.objectUrl,a=n.worker,this.workers.push({worker:a,objectUrl:o}),this.availableWorkers.push(a)):(c=n,u.webWorkerError=!!n);this.workerError=c,this.canvas=i.createElement("canvas"),this.canvas.width=e.gifWidth,this.canvas.height=e.gifHeight,this.ctx=this.canvas.getContext("2d"),this.frames=[]},getWorker:function(){return this.availableWorkers.pop()},freeWorker:function(e){this.availableWorkers.push(e)},byteMap:function(){for(var e=[],t=0;t<256;t++)e[t]=String.fromCharCode(t);return e}(),bufferToString:function(e){for(var t=e.length,r="",n=-1;++n<t;)r+=this.byteMap[e[n]];return r},onFrameFinished:function(e){var t=this,r=t.frames,n=!!(t.options.images||[]).length,i=r.every((function(e){return!e.beingProcessed&&e.done}));t.numRenderedFrames++,n&&e(t.numRenderedFrames/r.length),t.onRenderProgressCallback(.75*t.numRenderedFrames/r.length),i?t.generatingGIF||t.generateGIF(r,t.onRenderCompleteCallback):u.requestTimeout((function(){t.processNextFrame()}),1)},processFrame:function(e){var t=this,r=(this.options,this.options),n=r.progressCallback,i=r.sampleInterval,o=this.frames,s=void 0,c=void 0,u=function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},r=e.data;delete s.data,s.pixels=Array.prototype.slice.call(r.pixels),s.palette=Array.prototype.slice.call(r.palette),s.done=!0,s.beingProcessed=!1,t.freeWorker(c),t.onFrameFinished(n)};(s=o[e]).beingProcessed||s.done?this.onFrameFinished():(s.sampleInterval=i,s.beingProcessed=!0,s.gifshot=!0,(c=this.getWorker())?(c.onmessage=u,c.postMessage(s)):u({data:t.workerMethods.run(s)}))},startRendering:function(e){this.onRenderCompleteCallback=e;for(var t=0;t<this.options.numWorkers&&t<this.frames.length;t++)this.processFrame(t)},processNextFrame:function(){for(var e=-1,t=0;t<this.frames.length;t++){var r=this.frames[t];if(!r.done&&!r.beingProcessed){e=t;break}}e>=0&&this.processFrame(e)},generateGIF:function(e,t){var r=[],n={loop:this.repeat},i=this.options,o=i.interval,a=i.frameDuration,s=!!i.images.length,c=i.gifHeight,l=i.gifWidth,d=new y(r,l,c,n),f=this.onRenderProgressCallback,h=s?100*o:0,p=void 0;this.generatingGIF=!0,u.each(e,(function(t,r){var n=r.palette;f(.75+.25*r.position*1/e.length);for(var i=0;i<a;i++)d.addFrame(0,0,l,c,r.pixels,{palette:n,delay:h})})),d.end(),f(1),this.frames=[],this.generatingGIF=!1,u.isFunction(t)&&(p=this.bufferToString(r),t("data:image/gif;base64,"+u.btoa(p)))},setRepeat:function(e){this.repeat=e},addFrame:function(e,t,r){t=u.isObject(t)?t:{};var n=this.ctx,i=this.options,o=i.gifWidth,a=i.gifHeight,s=u.getFontSize(t),c=t,l=c.filter,d=c.fontColor,f=c.fontFamily,h=c.fontWeight,p=(c.gifHeight,c.gifWidth,c.text),m=c.textAlign,g=c.textBaseline,b=c.waterMark,v=c.waterMarkHeight,y=c.waterMarkWidth,w=c.waterMarkXCoordinate,x=c.waterMarkYCoordinate,S=t.textXCoordinate?t.textXCoordinate:"left"===m?1:"right"===m?o:o/2,E=t.textYCoordinate?t.textYCoordinate:"top"===g?1:"center"===g?a/2:a,_=h+" "+s+" "+f,k=r&&t.showFrameText?r:p,C=void 0;try{n.filter=l,n.clearRect(0,0,o,a),n.drawImage(e,0,0,o,a),k&&(n.font=_,n.fillStyle=d,n.textAlign=m,n.textBaseline=g,n.fillText(k,S,E)),b&&n.drawImage(b,w,x,y,v),C=n.getImageData(0,0,o,a),this.addFrameImageData(C)}catch(e){return""+e}},addFrameImageData:function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=this.frames,r=e.data;this.frames.push({data:r,width:e.width,height:e.height,palette:null,dithering:null,done:!1,beingProcessed:!1,position:t.length})},onRenderProgress:function(e){this.onRenderProgressCallback=e},isRendering:function(){return this.generatingGIF},getBase64GIF:function(e){var t=this;t.startRendering((function(r){t.destroyWorkers(),u.requestTimeout((function(){e(r)}),0)}))},destroyWorkers:function(){if(!this.workerError){var e=this.workers;u.each(e,(function(e,t){var r=t.worker,n=t.objectUrl;r.terminate(),u.URL.revokeObjectURL(n)}))}}};var S=function(){},E={getGIF:function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=arguments[1];t=u.isFunction(t)?t:S;var r=i.createElement("canvas"),n=void 0,o=e.images,s=!!o.length,c=e.cameraStream,l=e.crop,d=e.filter,f=e.fontColor,h=e.fontFamily,p=e.fontWeight,m=e.keepCameraOn,g=(e.numWorkers,e.progressCallback),b=e.saveRenderingContexts,v=e.savedRenderingContexts,y=e.text,w=e.textAlign,E=e.textBaseline,_=e.videoElement,k=e.videoHeight,C=e.videoWidth,O=e.webcamVideoElement,F=e.waterMark,T=e.waterMarkHeight,A=e.waterMarkWidth,M=e.waterMarkXCoordinate,W=e.waterMarkYCoordinate,j=Number(e.gifWidth),I=Number(e.gifHeight),U=Number(e.interval),R=(Number(e.sampleInterval),s?0:1e3*U),P=[],H=v.length?v.length:e.numFrames,V=H,L=new x(e),D=u.getFontSize(e),z=e.textXCoordinate?e.textXCoordinate:"left"===w?1:"right"===w?j:j/2,B=e.textYCoordinate?e.textYCoordinate:"top"===E?1:"center"===E?I/2:I,N=p+" "+D+" "+h,G=l?Math.floor(l.scaledWidth/2):0,q=l?C-l.scaledWidth:0,Y=l?Math.floor(l.scaledHeight/2):0,X=l?k-l.scaledHeight:0,Q=function e(){var r=V-1;function i(){var i;b&&P.push(n.getImageData(0,0,j,I)),F&&n.drawImage(F,M,W,A,T),y&&(n.font=N,n.fillStyle=f,n.textAlign=w,n.textBaseline=E,n.fillText(y,z,B)),i=n.getImageData(0,0,j,I),L.addFrameImageData(i),g((H-(V=r))/H),r>0&&u.requestTimeout(e,R),V||L.getBase64GIF((function(e){t({error:!1,errorCode:"",errorMsg:"",image:e,cameraStream:c,videoElement:_,webcamVideoElement:O,savedRenderingContexts:P,keepCameraOn:m})}))}v.length?(n.putImageData(v[H-V],0,0),i()):function e(){try{q>C&&(q=C),X>k&&(X=k),G<0&&(G=0),Y<0&&(Y=0),n.filter=d,n.clearRect(G,Y,q,X),n.drawImage(_,G,Y,q,X,0,0,j,I),i()}catch(t){if("NS_ERROR_NOT_AVAILABLE"!==t.name)throw t;u.requestTimeout(e,100)}}()};H=H!==a?H:10,U=U!==a?U:.1,r.width=j,r.height=I,n=r.getContext("2d"),function e(){v.length||0!==_.currentTime?Q():u.requestTimeout(e,100)}()},getCropDimensions:function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=e.videoWidth,r=e.videoHeight,n=e.gifWidth,i=e.gifHeight,o={width:0,height:0,scaledWidth:0,scaledHeight:0};return t>r?(o.width=Math.round(t*(i/r))-n,o.scaledWidth=Math.round(o.width*(r/i))):(o.height=Math.round(r*(n/t))-i,o.scaledHeight=Math.round(o.height*(t/n))),o}},_={loadedData:!1,defaultVideoDimensions:{width:640,height:480},findVideoSize:function e(t){e.attempts=e.attempts||0;var r=t.cameraStream,n=t.completedCallback,i=t.videoElement;i&&(i.videoWidth>0&&i.videoHeight>0?(i.removeEventListener("loadeddata",_.findVideoSize),n({videoElement:i,cameraStream:r,videoWidth:i.videoWidth,videoHeight:i.videoHeight})):e.attempts<10?(e.attempts+=1,u.requestTimeout((function(){_.findVideoSize(t)}),400)):n({videoElement:i,cameraStream:r,videoWidth:_.defaultVideoDimensions.width,videoHeight:_.defaultVideoDimensions.height}))},onStreamingTimeout:function(e){u.isFunction(e)&&e({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - Timed out while trying to start streaming",image:null,cameraStream:{}})},stream:function(e){var t=u.isArray(e.existingVideo)?e.existingVideo[0]:e.existingVideo,r=e.cameraStream,n=e.completedCallback,i=e.streamedCallback,o=e.videoElement;if(u.isFunction(i)&&i(),t){if(u.isString(t))o.src=t,o.innerHTML='<source src="'+t+'" type="video/'+u.getExtension(t)+'" />';else if(t instanceof Blob){try{o.src=u.URL.createObjectURL(t)}catch(e){}o.innerHTML='<source src="'+t+'" type="'+t.type+'" />'}}else if(o.mozSrcObject)o.mozSrcObject=r;else if(u.URL)try{o.srcObject=r,o.src=u.URL.createObjectURL(r)}catch(e){o.srcObject=r}o.play(),u.requestTimeout((function e(){e.count=e.count||0,!0===_.loadedData?(_.findVideoSize({videoElement:o,cameraStream:r,completedCallback:n}),_.loadedData=!1):(e.count+=1)>10?_.findVideoSize({videoElement:o,cameraStream:r,completedCallback:n}):e()}),0)},startStreaming:function(e){var t=u.isFunction(e.error)?e.error:u.noop,r=u.isFunction(e.streamed)?e.streamed:u.noop,n=u.isFunction(e.completed)?e.completed:u.noop,o=e.crossOrigin,a=e.existingVideo,s=e.lastCameraStream,c=e.options,l=e.webcamVideoElement,d=u.isElement(a)?a:l||i.createElement("video");o&&(d.crossOrigin=c.crossOrigin),d.autoplay=!0,d.loop=!0,d.muted=!0,d.addEventListener("loadeddata",(function(e){_.loadedData=!0,c.offset&&(d.currentTime=c.offset)})),a?_.stream({videoElement:d,existingVideo:a,completedCallback:n}):s?_.stream({videoElement:d,cameraStream:s,streamedCallback:r,completedCallback:n}):u.getUserMedia({video:!0},(function(e){_.stream({videoElement:d,cameraStream:e,streamedCallback:r,completedCallback:n})}),t)},startVideoStreaming:function(e){var t=arguments.length>1&&arguments[1]!==a?arguments[1]:{},r=t.timeout!==a?t.timeout:0,n=t.callback,i=t.webcamVideoElement,o=void 0;r>0&&(o=u.requestTimeout((function(){_.onStreamingTimeout(n)}),1e4)),_.startStreaming({error:function(){n({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - the user probably denied permission",image:null,cameraStream:{}})},streamed:function(){clearTimeout(o)},completed:function(){var t=arguments.length>0&&arguments[0]!==a?arguments[0]:{},r=t.cameraStream,n=t.videoElement,i=t.videoHeight,o=t.videoWidth;e({cameraStream:r,videoElement:n,videoHeight:i,videoWidth:o})},lastCameraStream:t.lastCameraStream,webcamVideoElement:i,crossOrigin:t.crossOrigin,options:t})},stopVideoStreaming:function(e){var t=e=u.isObject(e)?e:{},r=t.keepCameraOn,n=t.videoElement,i=t.webcamVideoElement,o=e.cameraStream||{},a=o.getTracks&&o.getTracks()||[],s=!!a.length,c=a[0];!r&&s&&u.isFunction(c.stop)&&c.stop(),u.isElement(n)&&!i&&(n.pause(),u.isFunction(u.URL.revokeObjectURL)&&!u.webWorkerError&&n.src&&u.URL.revokeObjectURL(n.src),u.removeElement(n))}};function k(e){e=u.isObject(e)?e:{},_.stopVideoStreaming(e)}function C(e,t){var r=e.options||{},n=r.images,o=r.video,a=Number(r.gifWidth),s=Number(r.gifHeight),c=(Number(r.numFrames),e.cameraStream),l=e.videoElement,d=e.videoWidth,f=e.videoHeight,h=E.getCropDimensions({videoWidth:d,videoHeight:f,gifHeight:s,gifWidth:a}),p=t;r.crop=h,r.videoElement=l,r.videoWidth=d,r.videoHeight=f,r.cameraStream=c,u.isElement(l)&&(l.width=a+h.width,l.height=s+h.height,r.webcamVideoElement||(u.setCSSAttr(l,{position:"fixed",opacity:"0"}),i.body.appendChild(l)),l.play(),E.getGIF(r,(function(e){n&&n.length||o&&o.length||k(e),p(e)})))}function O(e,t){if(t=u.isFunction(e)?e:t,e=u.isObject(e)?e:{},u.isFunction(t)){var r=u.mergeOptions(p,e)||{},n=e.cameraStream,o=r.images,s=o?o.length:0,c=r.video,l=r.webcamVideoElement;r=u.mergeOptions(r,{gifWidth:Math.floor(r.gifWidth),gifHeight:Math.floor(r.gifHeight)}),s?function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=e.callback,r=e.images,n=e.options,o=e.imagesLength,s=d.validate({getUserMedia:!0,"window.URL":!0}),c=[],l=0,f=void 0,h=void 0;if(s.error)return t(s);function p(){u.each(c,(function(e,t){t&&(t.text?h.addFrame(t.img,n,t.text):h.addFrame(t,n))})),function(e,t){e.getBase64GIF((function(e){t({error:!1,errorCode:"",errorMsg:"",image:e})}))}(h,t)}h=new x(n),u.each(r,(function(e,r){var a=r;r.src&&(a=a.src),u.isElement(a)?(n.crossOrigin&&(a.crossOrigin=n.crossOrigin),c[e]=a,(l+=1)===o&&p()):u.isString(a)&&(f=new Image,n.crossOrigin&&(f.crossOrigin=n.crossOrigin),function(n){r.text&&(n.text=r.text),n.onerror=function(e){var r=void 0;if(0===--o)return(r={}).error="None of the requested images was capable of being retrieved",t(r)},n.onload=function(t){r.text?c[e]={img:n,text:n.text}:c[e]=n,(l+=1)===o&&p(),u.removeElement(n)},n.src=a}(f),u.setCSSAttr(f,{position:"fixed",opacity:"0"}),i.body.appendChild(f))}))}({images:o,imagesLength:s,callback:t,options:r}):c?function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=e.callback,r=e.existingVideo,n=e.options,i=d.validate({getUserMedia:!0,"window.URL":!0}),o=void 0,s=void 0;if(i.error)return t(i);if(u.isElement(r)&&r.src){if(s=r.src,o=u.getExtension(s),!u.isSupported.videoCodecs[o])return t(d.messages.videoCodecs)}else u.isArray(r)&&u.each(r,(function(e,t){if(o=t instanceof Blob?t.type.substr(t.type.lastIndexOf("/")+1,t.length):t.substr(t.lastIndexOf(".")+1,t.length),u.isSupported.videoCodecs[o])return r=t,!1}));_.startStreaming({completed:function(e){e.options=n||{},C(e,t)},existingVideo:r,crossOrigin:n.crossOrigin,options:n})}({existingVideo:c,callback:t,options:r}):function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=e.callback,r=e.lastCameraStream,n=e.options,i=e.webcamVideoElement;if(!g())return t(d.validate());n.savedRenderingContexts.length?E.getGIF(n,(function(e){t(e)})):_.startVideoStreaming((function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{};e.options=n||{},C(e,t)}),{lastCameraStream:r,callback:t,webcamVideoElement:i,crossOrigin:n.crossOrigin})}({lastCameraStream:n,callback:t,webcamVideoElement:l,options:r})}}var F={utils:l,error:f,defaultOptions:m,createGIF:O,takeSnapShot:function(e,t){if(t=u.isFunction(e)?e:t,e=u.isObject(e)?e:{},u.isFunction(t)){var r=u.mergeOptions(p,e);O(u.mergeOptions(r,{interval:.1,numFrames:1,gifWidth:Math.floor(r.gifWidth),gifHeight:Math.floor(r.gifHeight)}),t)}},stopVideoStreaming:k,isSupported:function(){return d.isValid()},isWebCamGIFSupported:g,isExistingVideoGIFSupported:function(e){var t=!1;if(u.isArray(e)&&e.length){if(u.each(e,(function(e,r){u.isSupported.videoCodecs[r]&&(t=!0)})),!t)return!1}else if(u.isString(e)&&e.length&&!u.isSupported.videoCodecs[e])return!1;return d.isValid({getUserMedia:!0})},isExistingImagesGIFSupported:function(){return d.isValid({getUserMedia:!0})},VERSION:"0.4.5"};(n=function(){return F}.apply(t,[]))===a||(e.exports=n)}("undefined"!=typeof window?window:{},"undefined"!=typeof document?document:{createElement:function(){}},"undefined"!=typeof window?window.navigator:{})},function(e,t,r){"use strict";r.r(t);var n=r(0),i=r.n(n),o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function a(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function s(e){return"function"==typeof e}var c=!1,u={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack;c=e},get useDeprecatedSynchronousErrorHandling(){return c}};function l(e){setTimeout((function(){throw e}),0)}var d={closed:!0,next:function(e){},error:function(e){if(u.useDeprecatedSynchronousErrorHandling)throw e;l(e)},complete:function(){}},f=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}();function h(e){return null!==e&&"object"==typeof e}var p=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),m=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var r=this._parentOrParents,n=this._unsubscribe,i=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof e)r.remove(this);else if(null!==r)for(var o=0;o<r.length;++o){r[o].remove(this)}if(s(n))try{n.call(this)}catch(e){t=e instanceof p?g(e.errors):[e]}if(f(i)){o=-1;for(var a=i.length;++o<a;){var c=i[o];if(h(c))try{c.unsubscribe()}catch(e){t=t||[],e instanceof p?t=t.concat(g(e.errors)):t.push(e)}}}if(t)throw new p(t)}},e.prototype.add=function(t){var r=t;if(!t)return e.EMPTY;switch(typeof t){case"function":r=new e(t);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof e)){var n=r;(r=new e)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=r._parentOrParents;if(null===i)r._parentOrParents=this;else if(i instanceof e){if(i===this)return r;r._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return r;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[r]:o.push(r),r},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function g(e){return e.reduce((function(e,t){return e.concat(t instanceof p?t.errors:t)}),[])}var b=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),v=function(e){function t(r,n,i){var o=e.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=d;break;case 1:if(!r){o.destination=d;break}if("object"==typeof r){r instanceof t?(o.syncErrorThrowable=r.syncErrorThrowable,o.destination=r,r.add(o)):(o.syncErrorThrowable=!0,o.destination=new y(o,r));break}default:o.syncErrorThrowable=!0,o.destination=new y(o,r,n,i)}return o}return a(t,e),t.prototype[b]=function(){return this},t.create=function(e,r,n){var i=new t(e,r,n);return i.syncErrorThrowable=!1,i},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(m),y=function(e){function t(t,r,n,i){var o,a=e.call(this)||this;a._parentSubscriber=t;var c=a;return s(r)?o=r:r&&(o=r.next,n=r.error,i=r.complete,r!==d&&(s((c=Object.create(r)).unsubscribe)&&a.add(c.unsubscribe.bind(c)),c.unsubscribe=a.unsubscribe.bind(a))),a._context=c,a._next=o,a._error=n,a._complete=i,a}return a(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;u.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,r=u.useDeprecatedSynchronousErrorHandling;if(this._error)r&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)r?(t.syncErrorValue=e,t.syncErrorThrown=!0):l(e),this.unsubscribe();else{if(this.unsubscribe(),r)throw e;l(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};u.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),u.useDeprecatedSynchronousErrorHandling)throw e;l(e)}},t.prototype.__tryOrSetError=function(e,t,r){if(!u.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,r)}catch(t){return u.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(l(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(v);var w=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function x(){}function S(e){return e?1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}:x}var E=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n=this.operator,i=function(e,t,r){if(e){if(e instanceof v)return e;if(e[b])return e[b]()}return e||t||r?new v(e,t,r):new v(d)}(e,t,r);if(n?i.add(n.call(i,this.source)):i.add(this.source||u.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),u.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){u.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),!function(e){for(;e;){var t=e,r=t.closed,n=t.destination,i=t.isStopped;if(r||i)return!1;e=n&&n instanceof v?n:null}return!0}(e)?console.warn(t):e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=_(t))((function(t,n){var i;i=r.subscribe((function(t){try{e(t)}catch(e){n(e),i&&i.unsubscribe()}}),n,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[w]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:S(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=_(e))((function(e,r){var n;t.subscribe((function(e){return n=e}),(function(e){return r(e)}),(function(){return e(n)}))}))},e.create=function(t){return new e(t)},e}();function _(e){if(e||(e=u.Promise||Promise),!e)throw new Error("no Promise impl found");return e}function k(e,t){return function(r){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new C(e,t))}}var C=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new O(e,this.project,this.thisArg))},e}(),O=function(e){function t(t,r,n){var i=e.call(this,t)||this;return i.project=r,i.count=0,i.thisArg=n||i,i}return a(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(v);function F(e,t,r){return function(n){return n.lift(new T(e,t,r))}}var T=function(){function e(e,t,r){this.nextOrObserver=e,this.error=t,this.complete=r}return e.prototype.call=function(e,t){return t.subscribe(new A(e,this.nextOrObserver,this.error,this.complete))},e}(),A=function(e){function t(t,r,n,i){var o=e.call(this,t)||this;return o._tapNext=x,o._tapError=x,o._tapComplete=x,o._tapError=n||x,o._tapComplete=i||x,s(r)?(o._context=o,o._tapNext=r):r&&(o._context=r,o._tapNext=r.next||x,o._tapError=r.error||x,o._tapComplete=r.complete||x),o}return a(t,e),t.prototype._next=function(e){try{this._tapNext.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.next(e)},t.prototype._error=function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)},t.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()},t}(v),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.notifyNext=function(e,t,r,n,i){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(v),W=function(e){function t(t,r,n){var i=e.call(this)||this;return i.parent=t,i.outerValue=r,i.outerIndex=n,i.index=0,i}return a(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(v);function j(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var I=j(),U=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function R(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var P=function(e){if(e&&"function"==typeof e[w])return i=e,function(e){var t=i[w]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(U(e))return n=e,function(e){for(var t=0,r=n.length;t<r&&!e.closed;t++)e.next(n[t]);e.complete()};if(R(e))return r=e,function(e){return r.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,l),e};if(e&&"function"==typeof e[I])return t=e,function(e){for(var r=t[I]();;){var n=r.next();if(n.done){e.complete();break}if(e.next(n.value),e.closed)break}return"function"==typeof r.return&&e.add((function(){r.return&&r.return()})),e};var t,r,n,i,o=h(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+o+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function H(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[w]}(e))return function(e,t){return new E((function(r){var n=new m;return n.add(t.schedule((function(){var i=e[w]();n.add(i.subscribe({next:function(e){n.add(t.schedule((function(){return r.next(e)})))},error:function(e){n.add(t.schedule((function(){return r.error(e)})))},complete:function(){n.add(t.schedule((function(){return r.complete()})))}}))}))),n}))}(e,t);if(R(e))return function(e,t){return new E((function(r){var n=new m;return n.add(t.schedule((function(){return e.then((function(e){n.add(t.schedule((function(){r.next(e),n.add(t.schedule((function(){return r.complete()})))})))}),(function(e){n.add(t.schedule((function(){return r.error(e)})))}))}))),n}))}(e,t);if(U(e))return function(e,t){return new E((function(r){var n=new m,i=0;return n.add(t.schedule((function(){i!==e.length?(r.next(e[i++]),r.closed||n.add(this.schedule())):r.complete()}))),n}))}(e,t);if(function(e){return e&&"function"==typeof e[I]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new E((function(r){var n,i=new m;return i.add((function(){n&&"function"==typeof n.return&&n.return()})),i.add(t.schedule((function(){n=e[I](),i.add(t.schedule((function(){if(!r.closed){var e,t;try{var i=n.next();e=i.value,t=i.done}catch(e){return void r.error(e)}t?r.complete():(r.next(e),this.schedule())}})))}))),i}))}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}function V(e,t){return"function"==typeof t?function(r){return r.pipe(V((function(r,n){return(i=e(r,n),o?H(i,o):i instanceof E?i:new E(P(i))).pipe(k((function(e,i){return t(r,e,n,i)})));var i,o})))}:function(t){return t.lift(new L(e))}}var L=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new D(e,this.project))},e}(),D=function(e){function t(t,r){var n=e.call(this,t)||this;return n.project=r,n.index=0,n}return a(t,e),t.prototype._next=function(e){var t,r=this.index++;try{t=this.project(e,r)}catch(e){return void this.destination.error(e)}this._innerSub(t,e,r)},t.prototype._innerSub=function(e,t,r){var n=this.innerSubscription;n&&n.unsubscribe();var i=new W(this,void 0,void 0);this.destination.add(i),this.innerSubscription=function(e,t,r,n,i){if(void 0===i&&(i=new W(e,r,n)),!i.closed)return t instanceof E?t.subscribe(i):P(t)(i)}(this,e,t,r,i)},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||e.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=null},t.prototype.notifyComplete=function(t){this.destination.remove(t),this.innerSubscription=null,this.isStopped&&e.prototype._complete.call(this)},t.prototype.notifyNext=function(e,t,r,n,i){this.destination.next(t)},t}(M);var z=e=>new Promise((t,r)=>{const n=new FileReader;n.readAsDataURL(e),n.onload=e=>{const i=n.result,o=new Image;o.src=i,o.onload=e=>{const r=document.createElement("canvas");r.width=128,r.height=128;const n=r.getContext("2d");n.drawImage(o,0,0,128,128),t(n)},n.onerror=r}});var B=e=>new Promise(t=>{e.canvas.toBlob(e=>{const r=window.URL.createObjectURL(e);t(r)},"image/gif")});const N=document.getElementById("loader"),G=document.getElementById("animated-image"),q=document.getElementById("image"),Y=document.getElementById("empty"),X=document.getElementById("file-uploader");(function e(t,r,n,i){return s(n)&&(i=n,n=void 0),i?e(t,r,n).pipe(k((function(e){return f(e)?i.apply(void 0,e):i(e)}))):new E((function(e){!function e(t,r,n,i,o){var a;if(function(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}(t)){var s=t;t.addEventListener(r,n,o),a=function(){return s.removeEventListener(r,n,o)}}else if(function(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}(t)){var c=t;t.on(r,n),a=function(){return c.off(r,n)}}else if(function(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}(t)){var u=t;t.addListener(r,n),a=function(){return u.removeListener(r,n)}}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(var l=0,d=t.length;l<d;l++)e(t[l],r,n,i,o)}i.add(a)}(t,r,(function(t){arguments.length>1?e.next(Array.prototype.slice.call(arguments)):e.next(t)}),e,n)}))})(X,"change").pipe(k(e=>e.target.files),k(e=>e[0]),F(()=>{N.setAttribute("class","active"),X.setAttribute("disabled","disabled")}),V(z),V(B),F(e=>{q.src=e})).subscribe(()=>{const e=document.querySelectorAll("#image-group img"),t=q.src,r=[t,t,t,t,Y,Y,t,t,t,Y,Y,t,Y,Y,t,Y,t,Y,t,Y,t,Y,...Array.from(e).map(e=>e.src)];i.a.createGIF({gifWidth:128,gifHeight:128,images:r,interval:.1,numFrames:10,frameDuration:1,sampleInterval:10,numWorkers:2},e=>{N.removeAttribute("class"),X.removeAttribute("disabled"),e.error?alert("Failed to make explosion"):G.src=e.image})},()=>{N.removeAttribute("class"),X.removeAttribute("disabled"),alert("Failed to make explosion")})}])}));